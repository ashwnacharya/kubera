import datetime

_expiry_date_strings = [
    '28-01-2010',
    '25-02-2010',
    '25-03-2010',
    '29-04-2010',
    '27-05-2010',
    '24-06-2010',
    '29-07-2010',
    '26-08-2010',
    '30-09-2010',
    '28-10-2010',
    '25-11-2010',
    '30-12-2010',
    '27-01-2011',
    '24-02-2011',
    '31-03-2011',
    '28-04-2011',
    '26-05-2011',
    '30-06-2011',
    '28-07-2011',
    '25-08-2011',
    '16-09-2011',
    '29-09-2011',
    '21-10-2011',
    '25-10-2011',
    '18-11-2011',
    '24-11-2011',
    '16-12-2011',
    '29-12-2011',
    '25-01-2012',
    '23-02-2012',
    '29-03-2012',
    '26-04-2012',
    '31-05-2012',
    '28-06-2012',
    '26-07-2012',
    '30-08-2012',
    '27-09-2012',
    '25-10-2012',
    '29-11-2012',
    '27-12-2012',
    '31-01-2013',
    '28-02-2013',
    '28-03-2013',
    '25-04-2013',
    '30-05-2013',
    '27-06-2013',
    '25-07-2013',
    '29-08-2013',
    '26-09-2013',
    '31-10-2013',
    '28-11-2013',
    '26-12-2013',
    '30-01-2014',
    '21-02-2014',
    '27-02-2014',
    '27-03-2014',
    '24-04-2014',
    '29-05-2014',
    '26-06-2014',
    '31-07-2014',
    '28-08-2014',
    '25-09-2014',
    '30-10-2014',
    '27-11-2014',
    '24-12-2014',
    '29-01-2015',
    '26-02-2015',
    '26-03-2015',
    '30-04-2015',
    '28-05-2015',
    '25-06-2015',
    '30-07-2015',
    '27-08-2015',
    '24-09-2015',
    '29-10-2015',
    '26-11-2015',
    '31-12-2015',
]

expiry_dates = [datetime.datetime.strptime(date_string, '%d-%m-%Y')
                for date_string in _expiry_date_strings]

def get_option_expiry_date(date, series):
    series_0 = next((expiry_date for expiry_date
                     in expiry_dates if expiry_date >= date), None)

    if not series_0:
        return None

    index = expiry_dates.index(series_0) + series
    return expiry_dates[index]
